var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{d as r,c as o,s as n,aI as i,a as d,a5 as u,J as c,f as m,C as p,z as h,aD as f,u as v,h as k,e as g,m as y,l as j,H as x,O as _}from"./index-yFpGTzsr.js";import{E as b}from"./index-DO93zfDF.js";import{E as C}from"./index-BfU-oMPN.js";import{E}from"./index-fdAg_98Y.js";import{E as O}from"./index-DQ40BJeM.js";import{_ as V}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./aria-DZx3bhbH.js";import"./index-6xX-7Dk4.js";import"./token-DWNpOE8r.js";import"./index-CRtJWELv.js";import"./index-CC8M3ZFK.js";import"./index-Bk_Orbxo.js";import"./vnode-CPRGOU3L.js";import"./index-BtGO7k4f.js";import"./use-dialog-CMniSCyr.js";import"./refs-D5SKorsy.js";const K={style:{display:"flex","align-items":"center"}},w={key:0},M={key:1},$={class:"dialog-footer"},D=V(r({__name:"role-permission-dialog",props:{modelValue:{type:Boolean,default:!1},roleData:{default:void 0}},emits:["update:modelValue","success"],setup(e,{emit:r}){const V=e,D=r,H=o({get:()=>V.modelValue,set:e=>D("update:modelValue",e)}),{menuList:L}=n(i()),I=d(),P=d(!0),z=d(!1),A=o(()=>{const e=r=>{const o=((e,r)=>{for(var o in r||(r={}))t.call(r,o)&&s(e,o,r[o]);if(a)for(var o of a(r))l.call(r,o)&&s(e,o,r[o]);return e})({},r);if(r.meta&&r.meta.authList&&r.meta.authList.length){const e=r.meta.authList.map(e=>({id:`${r.id}_${e.authMark}`,name:`${r.name}_${e.authMark}`,label:e.title,authMark:e.authMark,isAuth:!0,checked:e.checked||!1}));o.children=o.children?[...o.children,...e]:e}return o.children&&(o.children=o.children.map(e)),o};return L.value.map(e)}),N={children:"children",label:e=>{var a;return f(null==(a=e.meta)?void 0:a.title)||""}};u(()=>V.modelValue,e=>{e&&V.roleData});const S=()=>{var e;H.value=!1,null==(e=I.value)||e.setCheckedKeys([])},U=()=>{_.success("权限保存成功"),D("success"),S()},B=()=>{const e=I.value;if(!e)return;const a=e.store.nodesMap;Object.values(a).forEach(e=>{e.expanded=!P.value}),P.value=!P.value},F=()=>{const e=I.value;if(e){if(z.value)e.setCheckedKeys([]);else{const a=J(A.value);e.setCheckedKeys(a)}z.value=!z.value}},J=e=>{const a=[],t=e=>{e.forEach(e=>{e.name&&a.push(e.name),e.children&&e.children.length>0&&t(e.children)})};return t(e),a},R=()=>{const e=I.value;if(!e)return;const a=e.getCheckedKeys(),t=J(A.value);z.value=a.length===t.length&&t.length>0},q=()=>{const e=I.value;if(!e)return;const a=e.getCheckedKeys(),t=e.getHalfCheckedKeys();e.getCheckedNodes(),e.getHalfCheckedNodes(),a.length,t.length;_.success(`已输出选中数据到控制台，共选中 ${a.length} 个节点`)};return(e,a)=>{const t=C,l=b,s=E,r=O;return m(),c(r,{modelValue:v(H),"onUpdate:modelValue":a[0]||(a[0]=e=>x(H)?H.value=e:null),title:"菜单权限",width:"520px","align-center":"",class:"el-dialog-border",onClose:S},{footer:p(()=>[k("div",$,[h(s,{onClick:q,style:{"margin-left":"8px"}},{default:p(()=>[...a[1]||(a[1]=[j("获取选中数据",-1)])]),_:1}),h(s,{onClick:B},{default:p(()=>[j(y(v(P)?"全部收起":"全部展开"),1)]),_:1}),h(s,{onClick:F,style:{"margin-left":"8px"}},{default:p(()=>[j(y(v(z)?"取消全选":"全部选择"),1)]),_:1}),h(s,{type:"primary",onClick:U},{default:p(()=>[...a[2]||(a[2]=[j("保存",-1)])]),_:1})])]),default:p(()=>[h(l,{height:"70vh"},{default:p(()=>[h(t,{ref_key:"treeRef",ref:I,data:v(A),"show-checkbox":"","node-key":"name","default-expand-all":v(P),"default-checked-keys":[1,2,3],props:N,onCheck:R},{default:p(({data:e})=>[k("div",K,[e.isAuth?(m(),g("span",w,y(e.label),1)):(m(),g("span",M,y(N.label(e)),1))])]),_:1},8,["data","default-expand-all"])]),_:1})]),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-d9ac0505"]]);export{D as default};
