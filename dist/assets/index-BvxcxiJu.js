var e=Object.defineProperty,a=Object.defineProperties,o=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(a,o,t)=>o in a?e(a,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[o]=t,n=(e,a)=>{for(var o in a||(a={}))r.call(a,o)&&l(e,o,a[o]);if(t)for(var o of t(a))s.call(a,o)&&l(e,o,a[o]);return e},i=(e,t)=>a(e,o(t));import{A as d,_ as p,a as c,E as m}from"./useTableColumns-BwuKCgn9.js";import{d as u,c as f,e as h,f as j,J as g,k as b,u as y,C as v,z as x,F as _,D as k,h as w,aa as C,g as O,at as P,m as B,a as S,y as V,I as T,ab as A,H as z,l as D,a8 as E,b5 as I,b6 as U,b7 as R,aZ as F,O as W}from"./index-yFpGTzsr.js";import{u as N,E as H}from"./useTable-CNbZov9q.js";import{u as $}from"./useAuth-BK68UFxb.js";import{E as G,a as J,b as L}from"./index-DaZI2gtB.js";import{_ as M}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{_ as Q}from"./role-search.vue_vue_type_script_setup_true_lang-Xt3InmT2.js";import X from"./role-edit-dialog-DLmYC3pT.js";import Z from"./role-permission-dialog-RCIk1vkN.js";import{E as q}from"./index-fdAg_98Y.js";import{E as K}from"./index-CrR44_AW.js";import{a as Y}from"./index-CJzd_x32.js";import"./index-Buke6wTe.js";import"./index-DO93zfDF.js";import"./aria-DZx3bhbH.js";import"./index-6xX-7Dk4.js";import"./index-B0zwy6BY.js";import"./index-BtGO7k4f.js";import"./_baseClone-DT29Da9y.js";import"./isArrayLikeObject-GHHsOzuO.js";import"./castArray-CNmYmr-F.js";import"./index-CC8M3ZFK.js";import"./index-DaXg2c4C.js";import"./index-yfFZu8ww.js";import"./vnode-CPRGOU3L.js";import"./refs-D5SKorsy.js";import"./index-4a6d5Oml.js";import"./index-B1ikFpPp.js";import"./index-CvaBRK4B.js";import"./index-BfU-oMPN.js";import"./token-DWNpOE8r.js";import"./index-CRtJWELv.js";import"./index-2Gw3B2Q1.js";import"./cloneDeep--BnNAqKF.js";import"./index-CguFuplp.js";import"./validator-g76rXS0E.js";import"./index-DQ40BJeM.js";import"./index-Bk_Orbxo.js";import"./use-dialog-CMniSCyr.js";const ee={class:"btn-more"},ae={class:"dropdown-item-content"},oe=M(u(i(n({},{name:"ArtButtonMore"}),{__name:"index",props:{list:{},auth:{},hasBackground:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:a}){const{hasAuth:o}=$(),t=e,r=f(()=>t.list.some(e=>!e.auth||o(e.auth))),s=a;return(e,a)=>{const t=d,l=C,n=J,i=G,p=L;return j(),h("div",ee,[y(r)?(j(),g(p,{key:0},{dropdown:v(()=>[x(i,null,{default:v(()=>[(j(!0),h(_,null,k(e.list,e=>(j(),h(_,{key:e.key},[!e.auth||y(o)(e.auth)?(j(),g(n,{key:0,disabled:e.disabled,onClick:a=>(e=>{s("click",e)})(e),class:"custom-dropdown-item"},{default:v(()=>[w("div",ae,[e.icon?(j(),g(l,{key:0,size:15,style:O({color:e.iconColor||e.color,margin:0})},{default:v(()=>[(j(),g(P(e.icon)))]),_:2},1032,["style"])):b("",!0),w("span",{style:O({color:e.color})},B(e.label),5)])]),_:2},1032,["disabled","onClick"])):b("",!0)],64))),128))]),_:1})]),default:v(()=>[x(t,{type:"more",iconBgColor:e.hasBackground?"":"transparent"},null,8,["iconBgColor"])]),_:1})):b("",!0)])}}})),[["__scopeId","data-v-78200c43"]]),te={class:"role-page art-full-height"},re=M(u(i(n({},{name:"Role"}),{__name:"index",setup(e){const a=S({roleName:void 0,roleCode:void 0,description:void 0,enabled:void 0,daterange:void 0}),o=S(!1),l=S(!1),d=S(!1),u=S(void 0),{columns:f,columnChecks:b,data:_,loading:k,pagination:w,getData:C,searchParams:P,resetSearchParams:B,handleSizeChange:$,handleCurrentChange:G,refreshData:J}=N({core:{apiFn:I,apiParams:{current:1,size:20},excludeParams:["daterange"],columnsFactory:()=>[{prop:"roleId",label:"角色ID",width:100},{prop:"roleName",label:"角色名称",minWidth:120},{prop:"roleCode",label:"角色编码",minWidth:120},{prop:"description",label:"角色描述",minWidth:150,showOverflowTooltip:!0},{prop:"enabled",label:"角色状态",width:100,formatter:e=>{const a=e.enabled?{type:"success",text:"启用"}:{type:"warning",text:"禁用"};return E(K,{type:a.type},()=>a.text)}},{prop:"createTime",label:"创建日期",width:180,sortable:!0},{prop:"operation",label:"操作",width:80,fixed:"right",formatter:e=>E("div",[E(oe,{list:[{key:"permission",label:"菜单权限",icon:U},{key:"edit",label:"编辑角色",icon:R},{key:"delete",label:"删除角色",icon:F,color:"#f56c6c"}],onClick:a=>ae(a,e)})])}]}}),L=S("add"),M=(e,a)=>{l.value=!0,L.value=e,u.value=a},ee=e=>{const a=e,{daterange:o}=a,l=((e,a)=>{var o={};for(var l in e)r.call(e,l)&&a.indexOf(l)<0&&(o[l]=e[l]);if(null!=e&&t)for(var l of t(e))a.indexOf(l)<0&&s.call(e,l)&&(o[l]=e[l]);return o})(a,["daterange"]),[d,p]=Array.isArray(o)?o:[null,null];Object.assign(P,i(n({},l),{startTime:d,endTime:p})),C()},ae=(e,a)=>{switch(e.key){case"permission":re(a);break;case"edit":M("edit",a);break;case"delete":se(a)}},re=e=>{d.value=!0,u.value=e},se=e=>{Y.confirm(`确定删除角色"${e.roleName}"吗？此操作不可恢复！`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{W.success("删除成功"),J()}).catch(()=>{W.info("已取消删除")})};return(e,t)=>{const r=q,s=H,n=p,i=c,C=m,P=V("ripple");return j(),h("div",te,[T(x(Q,{modelValue:y(a),"onUpdate:modelValue":t[0]||(t[0]=e=>z(a)?a.value=e:null),onSearch:ee,onReset:y(B)},null,8,["modelValue","onReset"]),[[A,y(o)]]),x(C,{class:"art-table-card",shadow:"never",style:O({"margin-top":y(o)?"12px":"0"})},{default:v(()=>[x(n,{columns:y(b),"onUpdate:columns":t[2]||(t[2]=e=>z(b)?b.value=e:null),showSearchBar:y(o),"onUpdate:showSearchBar":t[3]||(t[3]=e=>z(o)?o.value=e:null),loading:y(k),onRefresh:y(J)},{left:v(()=>[x(s,{wrap:""},{default:v(()=>[T((j(),g(r,{onClick:t[1]||(t[1]=e=>M("add"))},{default:v(()=>[...t[6]||(t[6]=[D("新增角色",-1)])]),_:1})),[[P]])]),_:1})]),_:1},8,["columns","showSearchBar","loading","onRefresh"]),x(i,{loading:y(k),data:y(_),columns:y(f),pagination:y(w),"onPagination:sizeChange":y($),"onPagination:currentChange":y(G)},null,8,["loading","data","columns","pagination","onPagination:sizeChange","onPagination:currentChange"])]),_:1},8,["style"]),x(X,{modelValue:y(l),"onUpdate:modelValue":t[4]||(t[4]=e=>z(l)?l.value=e:null),"dialog-type":y(L),"role-data":y(u),onSuccess:y(J)},null,8,["modelValue","dialog-type","role-data","onSuccess"]),x(Z,{modelValue:y(d),"onUpdate:modelValue":t[5]||(t[5]=e=>z(d)?d.value=e:null),"role-data":y(u),onSuccess:y(J)},null,8,["modelValue","role-data","onSuccess"])])}}})),[["__scopeId","data-v-a47e61d0"]]);export{re as default};
