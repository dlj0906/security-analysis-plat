import{R as e}from"./formData-roEEsqCx.js";import{a,E as l}from"./index-CvaBRK4B.js";import{E as r}from"./index-yfFZu8ww.js";import{c as s,a as o}from"./index-CrR44_AW.js";import{E as u}from"./index-fdAg_98Y.js";import{E as t}from"./index-DQ40BJeM.js";import{d,a as n,c as i,r as m,a5 as p,n as g,J as f,f as v,C as b,z as c,u as V,e as y,F as _,D as h,h as x,l as j,H as D,O as w}from"./index-yFpGTzsr.js";const C={class:"dialog-footer"},U=d({__name:"user-dialog",props:{visible:{type:Boolean},type:{},userData:{}},emits:["update:visible","submit"],setup(d,{emit:U}){const k=d,q=U,E=n(e),R=i({get:()=>k.visible,set:e=>q("update:visible",e)}),P=i(()=>k.type),z=n(),A=m({username:"",phone:"",gender:"男",role:[]}),N={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"blur"}]};p(()=>[k.visible,k.type,k.userData],([e])=>{e&&((()=>{const e="edit"===k.type&&k.userData,a=k.userData;Object.assign(A,{username:e&&a.userName||"",phone:e&&a.userPhone||"",gender:e&&a.userGender||"男",role:e&&Array.isArray(a.userRoles)?a.userRoles:[]})})(),g(()=>{var e;null==(e=z.value)||e.clearValidate()}))},{immediate:!0});const O=()=>{return e=null,a=null,l=function*(){z.value&&(yield z.value.validate(e=>{e&&(w.success("add"===P.value?"添加成功":"更新成功"),R.value=!1,q("submit"))}))},new Promise((r,s)=>{var o=e=>{try{t(l.next(e))}catch(a){s(a)}},u=e=>{try{t(l.throw(e))}catch(a){s(a)}},t=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,u);t((l=l.apply(e,a)).next())});var e,a,l};return(e,d)=>{const n=r,i=l,m=o,p=s,g=a,w=u,U=t;return v(),f(U,{modelValue:V(R),"onUpdate:modelValue":d[5]||(d[5]=e=>D(R)?R.value=e:null),title:"add"===V(P)?"添加用户":"编辑用户",width:"30%","align-center":""},{footer:b(()=>[x("div",C,[c(w,{onClick:d[4]||(d[4]=e=>R.value=!1)},{default:b(()=>[...d[6]||(d[6]=[j("取消",-1)])]),_:1}),c(w,{type:"primary",onClick:O},{default:b(()=>[...d[7]||(d[7]=[j("提交",-1)])]),_:1})])]),default:b(()=>[c(g,{ref_key:"formRef",ref:z,model:V(A),rules:N,"label-width":"80px"},{default:b(()=>[c(i,{label:"用户名",prop:"username"},{default:b(()=>[c(n,{modelValue:V(A).username,"onUpdate:modelValue":d[0]||(d[0]=e=>V(A).username=e)},null,8,["modelValue"])]),_:1}),c(i,{label:"手机号",prop:"phone"},{default:b(()=>[c(n,{modelValue:V(A).phone,"onUpdate:modelValue":d[1]||(d[1]=e=>V(A).phone=e)},null,8,["modelValue"])]),_:1}),c(i,{label:"性别",prop:"gender"},{default:b(()=>[c(p,{modelValue:V(A).gender,"onUpdate:modelValue":d[2]||(d[2]=e=>V(A).gender=e)},{default:b(()=>[c(m,{label:"男",value:"男"}),c(m,{label:"女",value:"女"})]),_:1},8,["modelValue"])]),_:1}),c(i,{label:"角色",prop:"role"},{default:b(()=>[c(p,{modelValue:V(A).role,"onUpdate:modelValue":d[3]||(d[3]=e=>V(A).role=e),multiple:""},{default:b(()=>[(v(!0),y(_,null,h(V(E),e=>(v(),f(m,{key:e.roleCode,value:e.roleCode,label:e.roleName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}});export{U as _};
