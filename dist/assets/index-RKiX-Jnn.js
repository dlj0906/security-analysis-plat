var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,i=(e,t)=>{for(var s in t||(t={}))l.call(t,s)&&o(e,s,t[s]);if(a)for(var s of a(t))r.call(t,s)&&o(e,s,t[s]);return e},n=(e,a)=>t(e,s(a));import{d as u,r as d,t as c,a as p,o as g,n as v,b as f,c as h,e as m,f as y,g as x,u as b,h as w,i as k,j as _,k as j,l as M,m as T,p as B,q as P,s as $,v as L,w as E,A as O,x as I,y as V,z as C,B as D,C as R,F as S,D as z,E as X,G as A,H as F,R as H,I as U,J as N,K as q,L as G,M as K,N as Y,O as J,P as W}from"./index-Bt2F3fsx.js";import{_ as Q}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{_ as Z}from"./index-D2f9F9ES.js";import{_ as ee}from"./LoginLeftView-Cz8RsCn9.js";import{E as te,a as se,b as ae}from"./index-V01GqruJ.js";import{E as le,a as re}from"./index-9JDm7yr7.js";import{E as oe}from"./index-CubyMTZl.js";import{E as ie}from"./index-BRyj0R8Q.js";import{E as ne}from"./index-B2c65Y4B.js";import"./index-CqsHCoqL.js";import"./index-CSaJqGkQ.js";import"./index-DKc9HdpN.js";import"./index-BaMjeaFB.js";import"./aria-DZx3bhbH.js";import"./index-Bg32yf_K.js";import"./castArray-DaEAnbfi.js";import"./refs-D0ZxbSzV.js";import"./_baseClone-DwHx1_gd.js";const ue=["innerHTML"],de=Q(u(n(i({},{name:"ArtDragVerify"}),{__name:"index",props:{value:{type:Boolean,default:!1},width:{default:"100%"},height:{default:40},text:{default:"按住滑块拖动"},successText:{default:"success"},background:{default:"#eee"},progressBarBg:{default:"#1385FF"},completedBg:{default:"#57D187"},circle:{type:Boolean,default:!1},radius:{default:"calc(var(--custom-radius) / 3 + 2px)"},handlerIcon:{default:"&#xea50;"},successIcon:{default:"&#xe621;"},handlerBg:{default:"#fff"},textSize:{default:"13px"},textColor:{default:"#333"}},emits:["handlerMove","update:value","passCallback"],setup(e,{expose:t,emit:s}){const a=s,l=e,r=d({isMoving:!1,x:0,isOk:!1}),{isOk:o}=c(r),i=p(),n=p(),u=p(),B=p();let P,$,L,E;const O=e=>{P=e.targetTouches[0].pageX,$=e.targetTouches[0].pageY},I=e=>{L=e.targetTouches[0].pageX,E=e.targetTouches[0].pageY,Math.abs(L-P)>Math.abs(E-$)&&e.preventDefault()};document.addEventListener("touchstart",O),document.addEventListener("touchmove",I,{passive:!1});const V=()=>{var e;return"string"==typeof l.width?(null==(e=i.value)?void 0:e.offsetWidth)||260:l.width};g(()=>{var e;null==(e=i.value)||e.style.setProperty("--textColor",l.textColor),v(()=>{var e,t;const s=V();null==(e=i.value)||e.style.setProperty("--width",Math.floor(s/2)+"px"),null==(t=i.value)||t.style.setProperty("--pwidth",-Math.floor(s/2)+"px")}),document.addEventListener("touchstart",O),document.addEventListener("touchmove",I,{passive:!1})}),f(()=>{document.removeEventListener("touchstart",O),document.removeEventListener("touchmove",I)});const C={left:"0",width:l.height+"px",height:l.height+"px",background:l.handlerBg},D=h(()=>({width:"string"==typeof l.width?l.width:l.width+"px",height:l.height+"px",lineHeight:l.height+"px",background:l.background,borderRadius:l.circle?l.height/2+"px":l.radius})),R={background:l.progressBarBg,height:l.height+"px",borderRadius:l.circle?l.height/2+"px 0 0 "+l.height/2+"px":l.radius},S=h(()=>({fontSize:l.textSize})),z=h(()=>l.value?l.successText:l.text),X=e=>{l.value||(r.isMoving=!0,u.value.style.transition="none",r.x=(e.pageX||e.touches[0].pageX)-parseInt(u.value.style.left.replace("px",""),10)),a("handlerMove")},A=e=>{if(r.isMoving&&!l.value){const t=V();let s=(e.pageX||e.touches[0].pageX)-r.x;s>0&&s<=t-l.height?(u.value.style.left=s+"px",B.value.style.width=s+l.height/2+"px"):s>t-l.height&&(u.value.style.left=t-l.height+"px",B.value.style.width=t-l.height/2+"px",H())}},F=e=>{if(r.isMoving&&!l.value){const t=V();(e.pageX||e.changedTouches[0].pageX)-r.x<t-l.height?(r.isOk=!0,u.value.style.left="0",u.value.style.transition="all 0.2s",B.value.style.width="0",r.isOk=!1):(u.value.style.transition="none",u.value.style.left=t-l.height+"px",B.value.style.width=t-l.height/2+"px",H()),r.isMoving=!1}},H=()=>{a("update:value",!0),r.isMoving=!1,B.value.style.background=l.completedBg,n.value.style["-webkit-text-fill-color"]="unset",n.value.style.animation="slidetounlock2 2s cubic-bezier(0, 0.2, 1, 1) infinite",n.value.style.color="#fff",a("passCallback")};return t({reset:()=>{u.value.style.left="0",B.value.style.width="0",u.value.children[0].innerHTML=l.handlerIcon,n.value.style["-webkit-text-fill-color"]="transparent",n.value.style.animation="slidetounlock 2s cubic-bezier(0, 0.2, 1, 1) infinite",n.value.style.color=l.background,a("update:value",!1),r.isOk=!1,r.isMoving=!1,r.x=0}}),(e,t)=>(y(),m("div",{ref_key:"dragVerify",ref:i,class:"drag_verify",style:x(b(D)),onMousemove:A,onMouseup:F,onMouseleave:F,onTouchmove:A,onTouchend:F},[w("div",{class:k(["dv_progress_bar",{goFirst2:b(o)}]),ref_key:"progressBar",ref:B,style:R},null,2),w("div",{class:"dv_text",style:x(b(S)),ref_key:"messageRef",ref:n},[e.$slots.textBefore?_(e.$slots,"textBefore",{key:0},void 0,!0):j("",!0),M(" "+T(b(z))+" ",1),e.$slots.textAfter?_(e.$slots,"textAfter",{key:1},void 0,!0):j("",!0)],4),w("div",{class:k(["dv_handler dv_handler_bg",{goFirst:b(o)}]),onMousedown:X,onTouchstart:X,ref_key:"handler",ref:u,style:C},[w("i",{class:"iconfont-sys",innerHTML:e.value?e.successIcon:e.handlerIcon},null,8,ue)],34)],36))}})),[["__scopeId","data-v-293ffbae"]]),ce={class:"login"},pe={class:"right-wrap"},ge={class:"top-right-wrap"},ve={class:"iconfont-sys"},fe={class:"menu-txt"},he={key:0,class:"iconfont-sys icon-check"},me={class:"header"},ye={class:"login-wrap"},xe={class:"form"},be={class:"title"},we={class:"sub-title"},ke={class:"drag-verify"},_e={class:"forget-password"},je={style:{"margin-top":"30px"}},Me={class:"footer"},Te=Q(u(n(i({},{name:"Login"}),{__name:"index",setup(e){const{t:t}=B(),s=h(()=>[{key:"super",label:t("login.roles.super"),userName:"Super",password:"123456",roles:["R_SUPER"]}]),a=P(),{isDark:l}=$(a),r=p(),o=L(),i=E(),n=p(!1),u=p(!1),c=O.systemInfo.name,v=p(),f=d({account:"",username:"",password:"",rememberPassword:!0}),x=h(()=>({username:[{required:!0,message:t("login.placeholder[0]"),trigger:"blur"}],password:[{required:!0,message:t("login.placeholder[1]"),trigger:"blur"}]})),_=p(!1);g(()=>{Q("super")});const Q=e=>{var t,a;const l=s.value.find(t=>t.key===e);f.account=e,f.username=null!=(t=null==l?void 0:l.userName)?t:"",f.password=null!=(a=null==l?void 0:l.password)?a:""},ue=()=>{return e=null,t=null,s=function*(){if(v.value)try{if(!(yield v.value.validate()))return;if(!n.value)return void(u.value=!0);_.value=!0;const{username:e,password:t}=f,{token:s,refreshToken:a}=yield G({userName:e,password:t});if(!s)throw new Error("Login failed - no token received");o.setToken(s,a);const l=yield K();o.setUserInfo(l),o.setLoginStatus(!0),Be(),i.push("/")}catch(e){e instanceof Y||J.error("登录失败，请稍后重试")}finally{_.value=!1,Te()}},new Promise((a,l)=>{var r=e=>{try{i(s.next(e))}catch(t){l(t)}},o=e=>{try{i(s.throw(e))}catch(t){l(t)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(r,o);i((s=s.apply(e,t)).next())});var e,t,s},Te=()=>{r.value.reset()},Be=()=>{setTimeout(()=>{W({title:t("login.success.title"),type:"success",duration:2500,zIndex:1e4,message:`${t("login.success.message")}, ${c}!`})},150)},{locale:Pe}=B(),$e=e=>{Pe.value!==e&&(Pe.value=e,o.setLanguage(e))};return(e,t)=>{const s=ee,a=se,o=te,i=ae,d=Z,p=oe,g=le,h=de,B=ie,P=I("RouterLink"),$=ne,L=re,E=V("ripple");return y(),m("div",ce,[C(s),w("div",pe,[w("div",ge,[w("div",{class:"btn theme-btn",onClick:t[0]||(t[0]=(...e)=>b(D)&&b(D)(...e))},[w("i",ve,T(b(l)?"":""),1)]),C(i,{onCommand:$e,"popper-class":"langDropDownStyle"},{dropdown:R(()=>[C(o,null,{default:R(()=>[(y(!0),m(S,null,z(b(X),e=>(y(),m("div",{key:e.value,class:"lang-btn-item"},[C(a,{command:e.value,class:k({"is-selected":b(Pe)===e.value})},{default:R(()=>[w("span",fe,T(e.label),1),b(Pe)===e.value?(y(),m("i",he,"")):j("",!0)]),_:2},1032,["command","class"])]))),128))]),_:1})]),default:R(()=>[t[5]||(t[5]=w("div",{class:"btn language-btn"},[w("i",{class:"iconfont-sys icon-language"},"")],-1))]),_:1})]),w("div",me,[C(d,{class:"icon"}),w("h1",null,T(b(c)),1)]),w("div",ye,[w("div",xe,[w("h3",be,T(e.$t("login.title")),1),w("p",we,T(e.$t("login.subTitle")),1),C(L,{ref_key:"formRef",ref:v,model:b(f),rules:b(x),onKeyup:q(ue,["enter"]),style:{"margin-top":"25px"}},{default:R(()=>[C(g,{prop:"username"},{default:R(()=>[C(p,{placeholder:e.$t("login.placeholder[0]"),modelValue:b(f).username,"onUpdate:modelValue":t[1]||(t[1]=e=>b(f).username=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])]),_:1}),C(g,{prop:"password"},{default:R(()=>[C(p,{placeholder:e.$t("login.placeholder[1]"),modelValue:b(f).password,"onUpdate:modelValue":t[2]||(t[2]=e=>b(f).password=e),modelModifiers:{trim:!0},type:"password",radius:"8px",autocomplete:"off","show-password":""},null,8,["placeholder","modelValue"])]),_:1}),w("div",ke,[w("div",{class:k(["drag-verify-content",{error:!b(n)&&b(u)}])},[C(h,{ref_key:"dragVerify",ref:r,value:b(n),"onUpdate:value":t[3]||(t[3]=e=>F(n)?n.value=e:null),text:e.$t("login.sliderText"),textColor:"var(--art-gray-800)",successText:e.$t("login.sliderSuccessText"),progressBarBg:b(A)("--el-color-primary"),background:"var(--art-gray-200)",handlerBg:"var(--art-main-bg-color)"},null,8,["value","text","successText","progressBarBg"])],2),w("p",{class:k(["error-text",{"show-error-text":!b(n)&&b(u)}])},T(e.$t("login.placeholder[2]")),3)]),w("div",_e,[C(B,{modelValue:b(f).rememberPassword,"onUpdate:modelValue":t[4]||(t[4]=e=>b(f).rememberPassword=e)},{default:R(()=>[M(T(e.$t("login.rememberPwd")),1)]),_:1},8,["modelValue"]),C(P,{to:b(H).ForgetPassword},{default:R(()=>[M(T(e.$t("login.forgetPwd")),1)]),_:1},8,["to"])]),w("div",je,[U((y(),N($,{class:"login-btn",type:"primary",onClick:ue,loading:b(_)},{default:R(()=>[M(T(e.$t("login.btnText")),1)]),_:1},8,["loading"])),[[E]])]),w("div",Me,[w("p",null,[M(T(e.$t("login.noAccount"))+" ",1),C(P,{to:b(H).Register},{default:R(()=>[M(T(e.$t("login.register")),1)]),_:1},8,["to"])])])]),_:1},8,["model","rules"])])])])])}}})),[["__scopeId","data-v-4ca24740"]]);export{Te as default};
